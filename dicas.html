<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>

<!-- Mirrored from www.psantos.org/ribafs/access/dicas.htm by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Apr 2018 10:56:20 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>

   
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

   
  <meta name="Generator" content="Microsoft Word 97">

   
  <meta name="GENERATOR" content="Mozilla/4.7 [en] (Win98; I) [Netscape]">

   
  <meta name="Author" content="Ribamar FS">

   
  <title>Cantinho dos Amantes do Access - Dicas 2</title>
</head>


<body>


<table border="1" cols="8" width="100%">
  <tbody>
    <tr>

      <td>
      <center><font size="-1"><a href="introducao.html">Introdu&ccedil;&atilde;o</a></font></center>

      </td>


      <td>
      <center><font size="-1"><a href="tabelas.html">Tabelas</a></font></center>

      </td>


      <td>
      <center><font size="-1"><a href="relacionamentos.html">Relacionamentos</a></font></center>

      </td>


      <td>
      <center>&nbsp;<font size="-1"><a href="consultas.html">Consultas</a></font></center>

      </td>


      <td>
      <center><font size="-1"><a href="formularios.html">Formul&aacute;rios</a></font></center>

      </td>


      <td>
      <center>&nbsp;<font size="-1"><a href="relatorios.html">Relat&oacute;rios</a></font></center>

      </td>


      <td>
      <center>&nbsp;<font size="-1"><a href="macros.html">Macros</a></font></center>

      </td>


      <td>
      <center><font size="-1"><a href="modulos.html">M&oacute;dulos</a></font></center>

      </td>

    </tr>


    <tr>

      <td>
      <center><font size="-1"><a href="activex.html">ActiveX</a></font></center>

      </td>


      <td>
      <center>&nbsp;<font size="-1"><a href="automacao.html">Automa&ccedil;&atilde;oOLE</a></font></center>

      </td>


      <td>
      <center>&nbsp;<font size="-1"><a href="graficos.html">Gr&aacute;ficos</a></font></center>

      </td>


      <td>
      <center>&nbsp;<font size="-1"><a href="dao.html">DAO</a></font></center>

      </td>


      <td>
      <center>&nbsp;<font size="-1"><a href="sql.html">SQL</a></font></center>

      </td>


      <td>
      <center>&nbsp;<font size="-1"><a href="seguranca.html">Seguran&ccedil;a</a></font></center>

      </td>


      <td>
      <center><font size="-1"><a href="redes.html">Redes/ODBC</a></font></center>

      </td>


      <td>
      <center>&nbsp;<font size="-1"><a href="file:///E:/1Ribamar/1Sites/Access/dicas.htm">Dicas</a></font></center>

      </td>

    </tr>


    <tr>

      <td>
      <center>&nbsp;<font size="-1"><a href="cursoonline.html">Curso
Online</a></font></center>

      </td>


      <td>
      <center><font size="-1"><a href="wizards.html">Wizards</a></font></center>

      </td>


      <td>
      <center><font size="-1"><a href="ferramentas.html">Ferramentas</a></font></center>

      </td>


      <td>
      <center><font size="-1"><a href="help.html">Help</a></font></center>

      </td>


      <td>
      <center>&nbsp;<font size="-1"><a href="downloads.html">Downloads</a></font></center>

      </td>


      <td>
      <center>&nbsp;</center>
      </td>
    </tr>
  </tbody>
</table>
<center>
<p><b><font size="+2">DICAS</font></b></p>
</center>


<hr width="100%">
<a href="dicas2.html">Dicas2</a> - Como esta se&ccedil;&atilde;o engordou
um pouco, nasceu uma filha. Dicas Novas.
<p><a href="DicasPreferidas.html">Dicas Preferidas</a>
</p>
<p><b>Deixar na mem&oacute;ria o programa e ser executado numa determinada
hora! </b><a href="#_Toc471220763">*</a>
<br>
<b>Retornar que dia, m&ecirc;s e ano ser&aacute; de hoje a daqui 1
mes e 48 dias, por exemplo. </b><a href="#_Toc471220764">*</a>
<br>
<b>Transformar .mdb em .txt </b><a href="#_Toc471220766">*</a>
<br>
<b>Senha apenas para o Banco de Dados no Access 2 </b><a href="#_Toc471220767">*</a>
<br>
<b>Acessar a porta paralela do computador usando o Visual Basic </b><a href="#_Toc471220768">*</a>
<br>
<b>Mudar de campo com a tecla enter, pois s&oacute; consigo com o TAB
</b><a href="#_Toc471220769">*</a>
<br>
<b>Definir ENTER para saltar de campos, e n&atilde;o emitir um Beep
ap&oacute;s o ENTER ser pressionado </b><a href="#_Toc471220770">*</a>
<br>
<b>Ler o n&uacute;mero do HD para mostrar ao usu&aacute;rio do programa
o n&uacute;mero em uma tela </b><a href="#_Toc471220771">*</a>
<br>
<b>Atualizar um TextBox automaticamente ao preencher um determinado
item no DBCombo </b><a href="#_Toc471220772">*</a>
<br>
<b>Somar o conte&uacute;do de um campo e exibi-lo em uma textbox </b><a href="#_Toc471220774">*</a>
<br>
<b>Texto de uma caixa de texto selecionado quando a caixa tiver com
o foco </b><a href="#_Toc471220775">*</a>
<br>
<b>Impor uma per&iacute;odo de funcionamento para meu programa </b><a href="#_Toc471220776">*</a>
<br>
<b>Ao digitar o ponto do teclado num&eacute;rico, o progrma interprete
como v&iacute;rgula </b><a href="#_Toc471220777">*</a>
<br>
<b>Consulta em v&aacute;rias tabelas </b><a href="#_Toc471220778">*</a>
<br>
<b>Criar um campo num&eacute;rico com duas casas decimais em uma determinada
tabela, atrav&eacute;s de c&oacute;digo </b><a href="#_Toc471220779">*</a>
<br>
<b>Como registrar um OCX </b><a href="#_Toc471220780">*</a>
<br>
<b>Aplica&ccedil;&atilde;o Multiusu&aacute;ria com Windows 3.11 </b><a href="#_Toc471220783">*</a>
<br>
<b>IMPRIMIR ARQUIVO TEXTO </b><a href="#_Toc471220784">*</a>
<br>
<b>Ler arquivo do Excel no VB ou Access </b><a href="#_Toc471220785">*</a>
<br>
<b>Par&aacute;bola </b><a href="#_Toc471220786">*</a>
<br>
<b>Como uma barra de progresso estabelecer o m&iacute;nimo (0%) como
sendo o inicio da copia de alguns arquivos e o m&aacute;ximo (100%) como
o final? </b><a href="#_Toc471220787">*</a>
<br>
<b>Pegar somente os 2 primeiros d&iacute;gitos de um n&uacute;mero
</b><a href="#_Toc471220788">*</a>
<br>
<b>N&uacute;mero de Linha em Arquivo Texto </b><a href="#_Toc471220789">*</a>
<br>
<b>Acelerando C&oacute;digo </b><a href="#_Toc471220790">*</a>
<br>
<b>Bot&atilde;o de Comando Redondo </b><a href="#_Toc471220791">*</a>
<br>
<b><a href="#Fazendo+AutoNumera%E7%E3o+voltar+a+iniciar+de+1">Fazendo AutoNumera&ccedil;&atilde;o
voltar a iniciar de 1 novamente</a></b>
</p>
<p><a name="_Toc471220763"></a><b><font size="+1">Deixar na memoria o programa
e ser executado numa determinada hora!</font></b>
</p>
<p>(Exemplo: &agrave;s 17:30).
</p>
<p>: Eh por forma Hide ??
</p>
<p>Uma forma &eacute; colocar no Form um controle Timer e testar nele se
chegou determinada hora.
</p>
<p>Ex:
</p>
<p>Private Sub Timer1_Timer()
</p>
<p>If format(now,"hh:nn") = "17:30" then call Aciona_Rotina
</p>
<p>end sub
<br>
&nbsp;
</p>
<p><a name="_Toc471220764"></a><b><font size="+1">Retornar que dia, m&ecirc;s
e ano ser&aacute; de hoje a daqui 1 mes e 48 dias, por exemplo.</font></b>
</p>
<p>: Ja tentei criar uma funcao,contudo devido a varia&ccedil;&otilde;es
dos dias dos meses e ainda de anos bissextos, acabei desistindo.
</p>
<p>Caro Alexandre
</p>
<p>Voc&ecirc; deve usar a Fun&ccedil;&atilde;o dateAdd a sintaxe voc&ecirc;
pega no
</p>
<p>Help do VB, mais a Solu&ccedil;&atilde;o Seria:
</p>
<p>DateAdd("d",78,Now)
</p>
<p>o "d" significa que Vou somar dias 78 = 1 mes e 48 dias
<br>
&nbsp;
</p>
<p><a name="_Toc471220766"></a><b><font size="+1">Transformar .mdb em .txt</font></b>
</p>
<p>Existe dois m&eacute;todos:
</p>
<p>1- usando o arquivo txt como se fosse uma tabela de um banco de dados
e usar comandos
</p>
<p>SQL para transportar os registros (nunca me lembro dos comandos)
</p>
<p>2- usando programa&ccedil;&atilde;o, como segue:
</p>
<p>Tabela.MoveFirst
</p>
<p>open "arquivo.txt" for output as #1
</p>
<p>do while not Tabela.EOF
</p>
<p>print #1, tabela!campo1 &amp; vbtab &amp; tabela!campo2 &amp; vbtab
....
</p>
<p>tabela.MoveNext
</p>
<p>loop
</p>
<p>close #1
</p>
<p>(cria um arquivo com campos de tamanho variavel separados por TAB)
<br>
&nbsp;
<br>
&nbsp;
</p>
<p><a name="_Toc471220767"></a><b><font size="+1">Senha apenas para o Banco
de Dados no Access 2</font></b>
</p>
<p>Eu tenho um Banco de Dados no Access e n&atilde;o gostaria de deixar
que o usu&aacute;rio pudesse abri-lo e fazer as altera&ccedil;&otilde;es
que achasse "melhor", pois talvez o programa n&atilde;o funcionaria corretamente,
portanto gostaria de acessar o banco de dados protegido apenas atrav&eacute;s
do programa.
</p>
<p>Obs.: Isso para o Acces2, que n&atilde;o tinha o recurso de senha apenas
para o Banco de Dados.
</p>
<p>: Desde j&aacute; agrade&ccedil;o,
</p>
<p>: Batata
</p>
<p>Use:
</p>
<p>Set BancoDeDados = OpenDatabase("C:\BANCO DE DADOS.MDB", False, False,
";pwd=suasenha")
</p>
<p>A senha &eacute; case sensitive.
<br>
&nbsp;
<br>
&nbsp;
</p>
<p><a name="_Toc471220768"></a><b><font size="+1">Acessar a porta paralela
do computador usando o Visual Basic</font></b>
</p>
<p>&eacute; simples:
</p>
<p>open "lpt1" as #1
</p>
<p>print #1, "texto"
</p>
<p>close #1
<br>
&nbsp;
<br>
&nbsp;
</p>
<p><a name="_Toc471220769"></a><b><font size="+1">Mudar de campo com a tecla
enter, pois s&oacute; consigo com o TAB</font></b>
</p>
<p>No evento Keypress insira o seguinte c&oacute;digo:
</p>
<p>If KeyAscii = 13 then
</p>
<p>SendKeys "{TAB}"
</p>
<p>KeyAscii = 0
</p>
<p>End If
<br>
&nbsp;
<br>
&nbsp;
</p>
<p><a name="_Toc471220770"></a><b><font size="+1">Definir ENTER para saltar
de campos, e n&atilde;o emitir um Beep ap&oacute;s o ENTER ser pressionado</font></b>
</p>
<p>Existe mais duas formas de fazer isso:
</p>
<p>Se voce quer que o efeito do ENTER funcione para todos os controles
</p>
<p>presentes no formulario:
</p>
<p>1) No evento Form_KeyPress insira o codigo:
</p>
<p>If KeyAscII = 13 then
</p>
<p>SendKeys "{Tab}"
</p>
<p>KeyAscII = 0
</p>
<p>endif
</p>
<p>2) Altere a propriedade KeyPreview do Form para True
</p>
<p>Se voce quer que o efeito do ENTER funcione num controle em
</p>
<p>especifico:
</p>
<p>1) No evento KeyPress do controle insira o codigo:
</p>
<p>If KeyAscII = 13 then
</p>
<p>SendKeys "{Tab}"
</p>
<p>KeyAscII = 0
</p>
<p>Endif
<br>
&nbsp;
<br>
&nbsp;
</p>
<p><a name="_Toc471220771"></a><b><font size="+1">Ler o n&uacute;mero do
HD para mostrar ao usu&aacute;rio do programa o n&uacute;mero em uma tela</font></b>
</p>
<p>Prezado Eduardo,
</p>
<p>Segue a rotina para verifica&ccedil;&atilde;o do Serial Number de qualquer
unidade
</p>
<p>registrada no Windows 95 ou Windows NT
</p>
<p>'Declara&ccedil;&atilde;o da API, s&oacute; funciona em VB32bits (4
ou 5)
</p>
<p>Private Declare Function GetVolumeInformation Lib "Kernel32" Alias "GetVolumeInformationA"
(ByVal lpRootPathName As String, ByVal lpVolumeNameBuffer As String, ByVal
nVolumeNameSize As Long, lpVolumeSerialNumber As Long, lpMaximumComponentLength
As Long, lpFileSystemFlags As Long, ByVal lpFileSystemNameBuffer As String,
ByVal nFileSystemNameSize As Long) As Long
</p>
<p>Private Sub mostra_serial()
</p>
<p>Dim lVSN As Long, n As Long, s1 As String, s2 As String
</p>
<p>Dim unidade As String
</p>
<p>Dim sTmp As String
</p>
<p>On Local Error Resume Next
</p>
<p>'especifica-se o diretorio raiz
</p>
<p>unidade = "C:\"
</p>
<p>'Reservando espa&ccedil;o para os string que ser&atilde;o passados para
a API
</p>
<p>s1 = String$(255, Chr$(0))
</p>
<p>s2 = String$(255, Chr$(0))
</p>
<p>n = GetVolumeInformation(unidade, s1, Len(s1), lVSN, 0, 0, s2, Len(s2))
</p>
<p>'s1 ter&aacute; o label da unidade
</p>
<p>'lVSN ter&aacute; o serial number
</p>
<p>'s2 indica o tipo de grava&ccedil;&atilde;o de arquivo (se FAT, etc...)
</p>
<p>'Numero IVSN (serial number) &eacute; convertido para hexadecimal para
ser mostrado como no DIR
</p>
<p>sTmp = Hex$(lVSN)
</p>
<p>Label3(0) = s1
</p>
<p>Label3(1) = Left$(sTmp, 4) &amp; "-" &amp; Right$(sTmp, 4)
</p>
<p>Label3(2) = s2
</p>
<p>End Sub
<br>
&nbsp;
</p>
<p><a name="_Toc471220774"></a><b><font size="+1">Somar o conte&uacute;do
de um campo e exibi-lo em uma textbox</font></b>
</p>
<p>Gilda Gomes,
</p>
<p>Vamos admitir que o TextBox destino seja Text1, a tabela contendo o
campo Valor se chame Tabela1, e que o banco de dados onde est&aacute; Tabela1
seja Banco1.MDB:
</p>
<p>Sub Exemplo()
</p>
<p>Dim BD as Database
</p>
<p>Dim strSQL as String, auxRS as Recordset
</p>
<p>Set BD = Workspaces(0).OpenDatabase("Banco1.MDB")
</p>
<p>strSQL = "select sum(Valor) as Soma" &amp; _
</p>
<p>" from Tabela1"
</p>
<p>Set auxRS = BD.OpenRecordset(strSQL)
</p>
<p>if Not IsNull(auxRS!Soma) then
</p>
<p>Text1 = auxRS!Soma
</p>
<p>End If
</p>
<p>auxRS.Close
</p>
<p>BD.Close
</p>
<p>End Sub
<br>
&nbsp;
</p>
<p><a name="_Toc471220775"></a><b><font size="+1">Texto de uma caixa de texto
selecionado quando a caixa tiver com o foco</font></b>
</p>
<p>Sim, isso &eacute; poss&iacute;vel.
</p>
<p>No evento GotFocus, escreva:
</p>
<p>Text1.SelStart = 0
</p>
<p>Text1.SelLength = Len(Text1)
<br>
&nbsp;
<br>
&nbsp;
</p>
<p><a name="_Toc471220776"></a><b><font size="+1">Impor uma per&iacute;odo
de funcionamento para meu programa</font></b>
</p>
<p>Prezado Silva,
</p>
<p>N&atilde;o vou escrever a rotina para voc&ecirc;, mas tenho uma id&eacute;ia
e vou expo-la:
</p>
<p>1-Na primeira execu&ccedil;&atilde;o do seu sistema, j&aacute; na tela
de abertura, verifique se &eacute; a primeira vez que o sistema &eacute;
rodado. Para tal, crie um banco de dados ou ent&atilde;o um arquivo binario
qualquer que registre a data do primeiro acesso. &Eacute; f&aacute;cil,
se a data do primeiro acesso estiver vazia, ent&atilde;o &eacute; a primeira
vez que o usu&aacute;rio acessa o sistema. Caso n&atilde;o queira usar
arquivos ou ent&atilde;o banco de dados para fazer isso, voc&ecirc; tamb&eacute;m
pode usar o registro do Windows. Pesquise no help a utiliza&ccedil;&atilde;o
dos comandos GETSETTING, DELETESETTING E SAVESETTING. Esses comandos com
certeza resolvem esse problema, pois permitem que voc&ecirc;, ao rodar
o software pela primeira vez, grave no registro a data.
</p>
<p>2-Caso o usu&aacute;rio j&aacute; tenha acessado, some a data do primeiro
acesso ao numero de dias que o usu&aacute;rio poder&aacute; utilizar o
seu sistema.
</p>
<p>3-Compare o resultado com a data atual do windows (fun&ccedil;&atilde;o
DATE). Caso a data seja maior que a data do sistema, ent&atilde;o o usu&aacute;rio
ainda n&atilde;o ultrapasso o limite de utiliza&ccedil;&atilde;o. Caso
contr&aacute;rio, fa&ccedil;a com que o sistema "caia", usando uma fun&ccedil;&atilde;o
EXIT SUB por exemplo.
</p>
<p>Espero ter ajudado,
<br>
&nbsp;
<br>
&nbsp;
</p>
<p><a name="_Toc471220777"></a><b><font size="+1">Ao digitar o ponto do teclado
num&eacute;rico, o progrma interprete como v&iacute;rgula</font></b>
</p>
<p>Parq que isso ocorra, tenho usado uma convers&atilde;o no KEY PRESS
// Format (CCUR(VAL( TEXTBOX.TEXT)), ##,##0.00), 9), por&eacute;m, ao utilizar
este textbox para uma soma/divis&atilde;o com outros valores, o n&uacute;mero
sempre sai arrendondado, ou com um desvio de 0,02.
</p>
<p>Oi Paulo,
</p>
<p>Para transformar ponto em virgula eu uso o seguinte
</p>
<p>codigo no evento KeyPress:
</p>
<p>char = Chr(KeyAscii)
</p>
<p>If char = "." Then KeyAscii = 44 &lsquo;intercepta o ponto e substitui pela
v&iacute;rgula
</p>
<p>O problema e que se voce for usar o valor da textbox para fazer outros
calculos, como parece ser o seu caso, o VB nao vai reconhecer a virgula
como separador de decimais. Tive muita dor de cabeca com isso, mas arranjei
uma solucao bisonha, mas que funciona.
</p>
<p>O codigo vai abaixo:
</p>
<p>valor = Txtvalor.Text
</p>
<p>pos = InStr(valor, ",") 'captura a posi&ccedil;&atilde;o da v&iacute;rgula
na string
</p>
<p>If pos &lt;&gt; 0 Then 'se o numero n&atilde;o tem v&iacute;rgula, InStr=0
</p>
<p>stresq = Left(valor, (pos - 1)) 'captura a parte inteira
</p>
<p>strdir = Right(valor, (Len(valor) - pos)) 'captura a parte decimal
</p>
<p>valor = stresq &amp; "." &amp; strdir 'concatena com um ponto
</p>
<p>Else
</p>
<p>valor = Val(TxtValor.Text) 'no caso do n&uacute;mero n&atilde;o ter
v&iacute;rgulas
</p>
<p>End If
<br>
&nbsp;
<br>
&nbsp;
</p>
<p><a name="_Toc471220778"></a><b><font size="+1">Consulta em v&aacute;rias
tabelas</font></b>
</p>
<p>Por exemplo , se eu tiver v&aacute;rias tabelas e quiser fazer uma consulta
em todas ao mesmo tempo e emitir um relat&oacute;rio desta consulta . Como
devo proceder ???
</p>
<p>Ai vai Ale...
</p>
<p>Voc&ecirc; n&atilde;o informa onde quer fazer as pesquisas...
</p>
<p>No VB vc pode usar o comando SQL a seguir:
</p>
<p>Dim sSqlCode as String
</p>
<p>Dim lObjConsulta as Object
</p>
<p>sSqlCode = ""
</p>
<p>sSqlCode = sSqlCode &amp; "Select * "
</p>
<p>sSqlCode = sSqlCode &amp; "From Tabela1, Tabela2, Tabela3, Tabela4,
... "
</p>
<p>sSqlCode = sSqlCode &amp; "Where Condicao"
</p>
<p>Set lObjConsulta = VariavelDoBancoDeDados.openrecordset(sSqlCode, snapshot)
</p>
<p>If lObjConsulta.bof and lObjConsulta.eof then 'nao foi encontrado nenhum
registro que satisfaca a condicao
</p>
<p>..
</p>
<p>..
</p>
<p>..
</p>
<p>..
</p>
<p>Else
</p>
<p>objeto1 = lObjConsulta.fields("campo1")
</p>
<p>objeto2 = lObjConsulta.fields("campo2")
</p>
<p>objeto3 = lObjConsulta.fields("campo3")
</p>
<p>objeto4 = lObjConsulta.fields("campo4")
</p>
<p>..
</p>
<p>..
</p>
<p>..
</p>
<p>..
</p>
<p>End If
<br>
&nbsp;
<br>
&nbsp;
</p>
<p><a name="_Toc471220779"></a><b><font size="+1">Criar um campo num&eacute;rico
com duas casas decimais em uma determinada tabela, atrav&eacute;s de c&oacute;digo</font></b>
</p>
<p>Criei meus arquivos via c&oacute;digo, mas n&atilde;o consigo armazenar
numero com casas decimais.
</p>
<p>Marcelo,
</p>
<p>Verifique se o tipo do campo que voc&ecirc; criou &eacute; algo como
dbSingle, dbDouble ou um dos demais tipos listados no Help que comportam
casas decimais; no Help, tamb&eacute;m, est&atilde;o os limites de cada
tipo.
<br>
&nbsp;
<br>
&nbsp;
</p>
<p><a name="_Toc471220780"></a><b><font size="+1">Como registrar um OCX</font></b>
</p>
<p>Luiz,
</p>
<p>voc&ecirc; pode registrar da seguinte forma:
</p>
<p>c:\vb\tools\regsvr32 c:\windows\system\keysta32.ocx
</p>
<p>Uu ent&atilde;o:
</p>
<p>C:\WINDOWS\SYSTEM\Regsvr32.exe RText.ocx
</p>
<p>Se voc&ecirc; quizer desregistrar use
</p>
<p>c:\vb\tools\regsvr32 /u c:\windows\system\keysta32.ocx
</p>
<p>Ou:
</p>
<p>C:\WINDOWS\SYSTEM\Regsvr32.exe /u RText.ocx
<br>
&nbsp;
</p>
<p><a name="_Toc471220783"></a><b><font size="+1">Aplica&ccedil;&atilde;o
Multiusu&aacute;ria com Windows 3.11</font></b>
</p>
<p>Estou desenvolvendo uma aplica&ccedil;&atilde;o multiusu&aacute;ria
para o ambiente Windows for Workgroup. Quero abrir uma tabela compartilhada
para dois terminais, onde possa incluir, alterar e excluir na mesma tabela
e ao mesmo tempo. Devo utilizar o acesso direto a uma Table ou utilizo
Dynaset? O Que &eacute; melhor?
</p>
<p>Resposta do MarcusVinicius: Para atualiza&ccedil;&atilde;o tanto faz.
O Table &eacute; mais r&aacute;pido do que o Dynaset, mas se voc&ecirc;
for fazer pesquisa, o Dynaset &eacute; mais indicado, uma vez que ele permite
que a consulta seja feita por qualquer campo, independente de ser ou n&atilde;o
chave e o Table exige que o mesmo seja chave prim&aacute;ria.
<br>
&nbsp;
</p>
<p><a name="_Toc471220784"></a><b><font size="+1">IMPRIMIR ARQUIVO TEXTO</font></b>
</p>
<p>M&eacute;todo para imprimir um arquivo texto, sem ter que abri-lo:
</p>
<p>"print app.path &amp; "\arquivo.txt"
<br>
&nbsp;
</p>
<p><a name="_Toc471220785"></a><b><font size="+1">Ler arquivo do Excel no
VB ou Access</font></b>
</p>
<p>A forma mais simples e que eu usaria seria gerar um TXT, o excel tem
essa op&ccedil;&atilde;o Salvar como.. e ent&atilde;o facilitaria a cria&ccedil;&atilde;o
de uma interface em Visual Basic para "ler" estes dados. Para ler este
arquivo TXT, cria-se um Type como vari&aacute;vel de leitura e abrir o
arquivo como randon.
<br>
&nbsp;
</p>
<p><a name="_Toc471220786"></a><b><font size="+1">Par&aacute;bola</font></b>
</p>
<p>1 - &Eacute; Poss&iacute;vel fazer uma par&aacute;bola?
</p>
<p>A maneira mais f&aacute;cil de se tra&ccedil;ar uma curva &eacute; usando
coordenadas polares. A equa&ccedil;&atilde;o da par&aacute;bola &eacute;:
</p>
<p>ro= p / (1 - cos(alfa))
</p>
<p>onde p &eacute; a dist&acirc;ncia que a par&aacute;bola corta o eixo
dos x.
</p>
<p>Para o tra&ccedil;ado de um programinha seria mais ou menos assim:
</p>
<p>p = 1
</p>
<p>a = 0
</p>
<p>ang = a * 3.141592/180
</p>
<p>ro = p / (1. - cos(ang)
</p>
<p>xa = cos(ang) * ro
</p>
<p>ya = sin(ang) * ro
</p>
<p>pset (xa,ya)
</p>
<p>for a = 0 to 360 step 5
</p>
<p>ang = a * 3.141592/180
</p>
<p>ro = p / (1. - cos(ang)
</p>
<p>xa = cos(ang) * ro
</p>
<p>ya = sin(ang) * ro
</p>
<p>line -(xa,ya)
</p>
<p>next a
</p>
<p>Eu n&atilde;o testei, mas acredito que esta certo. Eu fiz de 0 a 360,
isto far&aacute; a curva ser tra&ccedil;ada de - a + infinito.
<br>
&nbsp;
</p>
<p><a name="_Toc471220787"></a><b><font size="+1">Como uma barra de progresso
estabelecer o m&iacute;nimo (0%) como sendo o inicio da copia de alguns
arquivos e o m&aacute;ximo (100%) como o final?</font></b>
</p>
<p>Se voc&ecirc; tem n arquivos para passar para porcentagem &eacute;:
</p>
<p>for a= 1 to n
</p>
<p>perc = a*100/n
</p>
<p>manda para o slicer o perc
</p>
<p>next a
<br>
&nbsp;
</p>
<p>Fun&ccedil;&atilde;o Rnd realmente rand&ocirc;mica
</p>
<p>Fun&ccedil;&atilde;o Rnd sempre &eacute; constante. Por exemplo: quando
coloco ela variando de 0 a 100 o primeiro valor sempre &eacute; 95 o segundo
51 o terceiro 37 e assim por diante... gostaria ent&atilde;o de algum jeito
que realmente fosse rand&ocirc;mico.
</p>
<p>------
</p>
<p>O problema &eacute; que voc&ecirc; est&aacute; dando sempre a mesma
semente, no randomize(), use o timer como semente, ai cada vez ser&aacute;
uma nova sequ&ecirc;ncia de n&eacute;meros.
<br>
&nbsp;
</p>
<p><a name="_Toc471220788"></a><b><font size="+1">Pegar somente os 2 primeiros
d&iacute;gitos de um n&uacute;mero</font></b>
</p>
<p>Tenho por exemplo um numero 3,531309834738E 04 tem como eu pegar somente
</p>
<p>as 2 primeiras casas desse n&uacute;mero?
</p>
<p>Se voc&ecirc; est&aacute; necessitando do n&uacute;mero mesmo, e n&atilde;o
de uma representa&ccedil;&atilde;o dele seria alguma coisas assim:
</p>
<p>numero= 3.14159265
</p>
<p>num = val(format(numero,"0.00"))
</p>
<p>se voc&ecirc; quizer mais precis&atilde;o mude o "0.00" para "0.000"
e assim por diante.
<br>
&nbsp;
</p>
<p><a name="_Toc471220789"></a><b><font size="+1">N&uacute;mero de Linha
em Arquivo Texto</font></b>
</p>
<p>1) Ajuda!!! Algu&eacute;m sabe como gerar o n&uacute;mero de linhas
de um arquivo
</p>
<p>texto (formato lista)?
</p>
<p>Se for para colocar o numero da linha antes da linha, basta vc fazer:
</p>
<p>open "seutexto.txt" for input as #1
</p>
<p>open "Temp.txt" for output as #2
</p>
<p>while not EOF(1)
</p>
<p>line input #1, strTemp
</p>
<p>Conta = Conta + 1
</p>
<p>print #2, Format(Conta,"000") + strTemp
</p>
<p>wend
</p>
<p>Close #1
</p>
<p>Close #2
</p>
<p>kill "seutexto.txt"
</p>
<p>Name "Temp.txt" as "seutexto.txt"
</p>
<p>OUTRA:
</p>
<p>Para contar o n&uacute;mero de linhas, vc tem q ler linha a linha e
ir contando, por exemplo:
</p>
<p>Open "c:\autoexec.bat" for input as #1
</p>
<p>Do Until Eof(1)
</p>
<p>Line Input #1, Linha
</p>
<p>Contador = Contador +1
</p>
<p>loop
</p>
<p>Close #1
</p>
<p>msgbox "O Autoexec.bat tem " &amp; Contador &amp; " Linhas"
<br>
&nbsp;
</p>
<p><a name="_Toc471220790"></a><b><font size="+1">Acelerando C&oacute;digo</font></b>
</p>
<p>1. Voc&ecirc; poderia usar nomes mais esclarecedores para suas vari&aacute;veis.
Fica mais claro.
</p>
<p>2. Antes de come&ccedil;ar um bloco grande que faz uma coisa s&oacute;,
coloque um coment&aacute;rio.
</p>
<p>3. Divida o programa em procedimentos.
</p>
<p>4. Estabele&ccedil;a tipos fixos para as vari&aacute;veis (String, Integer,
Boolean, etc.).
<br>
&nbsp;
</p>
<p><a name="_Toc471220791"></a><b><font size="+1">Bot&atilde;o de Comando
Redondo</font></b>
</p>
<p>De qualquer forma, a&iacute; vai uma dica para voc&ecirc; construir
um bot&atilde;o redondo:
</p>
<p>INGREDIENTES:
</p>
<p>3 controles Shape (estilo Circle)
</p>
<p>1 controle Label
</p>
<p>bastante paci&ecirc;ncia
</p>
<p>e muita criatividade!
</p>
<p>MODO DE FAZER:
</p>
<p>Insira um frame no form e coloque a propriedade BorderStyle = 0 (nenhuma).
</p>
<p>Dentro do frame, crie o bot&atilde;o superpondo os tr&ecirc;s shapes
de forma a criar um efeito 3D:
</p>
<p>Um shape (ShapeCima) deve ter ser preenchido com uma cor clara (branco
ou cinza claro) e o outro (ShapeBaixo) com cor escura (preto ou cinza escuro).
Posicione-os como um 8. O terceiro shape (ShapeFace) ir&aacute; sobrepor
os demais. Ajuste as propriedades Left e Top de ShapeCima e ShapeBaixo
para dar id&eacute;ia de luz e sombra. Lembre-se que ShapeCima e ShapeBaixo
devem ser maiores que ShapeFace.
</p>
<p>Monitore os eventos MouseDown e MouseUp do frame, assim voc&ecirc; fica
sabendo se o bot&atilde;o foi apertado ou n&atilde;o.
</p>
<p>Observe que um bot&atilde;o tradicional recebe "luz" no lado esquerdo
e no de cima, fazendo sombra em baixo e &agrave; direita quando ele est&aacute;
para cima.
</p>
<p>Voc&ecirc; deve fazer o mesmo com o bot&atilde;o redondo. Nos eventos
MouseUp e MouseDown troque as propriedades de FillColor de ShapeCima e
ShapeBaixo. Assim voc&ecirc; vai obter o efeito de apertado e solto.
</p>
<p>O frame entra na hist&oacute;ria apenas para responder aos eventos e
para que algumas de suas propriedades sejam usadas como, por exemplo, TooltipText.
</p>
<p>&Eacute; claro que aqui descrevi apenas o b&aacute;sico, mas um bot&atilde;o
tem propriedades e eventos que um frame n&atilde;o tem. Assim, ser&aacute;
preciso escrever c&oacute;digo para simular tudo isso. &Eacute; a&iacute;
que entram os ingredientes principais paci&ecirc;ncia e criatividade.
</p>
<p>Voc&ecirc; pode construir um novo controle, de forma que se possa alterar
o tamanho do bot&atilde;o, cor da face, alterar o caption, etc.
<br>
&nbsp;
</p>
<p><a name="_Toc471220792"></a><b><font size="+1">Transformar Arquivo TXT
em Tabela</font></b>
</p>
<p>Como fazer para transformar um arquivo .txt, para uma tabela do Visual
Basic 5.0
</p>
<p>Depure estas linhas que eu tirei de um programa que desenvolvi:
</p>
<p>Set BancoDeDados = OpenDatabase("C:\VisualRota\VisualRota.mdb")
</p>
<p>'APAGAR AS TABELAS EXISTENTES PARA GERAR AS NOVAS.
</p>
<p>BancoDeDados.Execute "DROP TABLE CGOR0770"
</p>
<p>'CRIA TABELAS NA MEMORIA
</p>
<p>Set TabelaTemporariaDEF = BancoDeDados.CreateTableDef("CGOR0770")
</p>
<p>'REALIZA REFERENCIA DAS TABELAS AO DIRET&Oacute;RIO DO ARQ TEXTO.
</p>
<p>TabelaTemporariaDEF.Connect = "TEXT;DATABASE=C:\VisualRota\"
</p>
<p>'CRIA RELACAO COM O ARQ. TEXT ESPECIFICO
</p>
<p>TabelaTemporariaDEF.SourceTableName = "arq770.txt"
</p>
<p>'CRIA O ARQUIVO
</p>
<p>BancoDeDados.TableDefs.Append TabelaTemporariaDEF
</p>
<p>'DELETA TODOS OS REGISTROS EXISTENTES NAS TABELAS DEFEITOS
</p>
<p>BancoDeDados.Execute "DELETE * FROM DEFEITOS;"
</p>
<p>'COPIA A TABELA RELACIONADA COM O ARQUIVO TEXTO PARA UMA OUTRA TABELA
</p>
<p>BancoDeDados.Execute "INSERT INTO DEFEITOS SELECT * FROM CGOR0770;"
</p>
<p>OBS: Me desculpe eu esqueci que vc ainda tem que definir o arquivo Schema.ini
com a estrutura do seu arquivo!
</p>
<p>Outro detalhe, esta rotina s&oacute; funcionar&aacute; se o seu arquivo
texto estiver todo alinhado em colunas, permitindo desta forma definir
os campos!
</p>
<p><a name="Fazendo uma mensagem Piscar em"></a><b><font size="+1">Fazendo
uma mensagem Piscar em Formul&aacute;rio</font></b>
</p>
<p>Para fazer uma mensagem de um controle piscar em um Formul&aacute;rio:
</p>
<p>Crie um controle R&oacute;tulo chamado lblPiscador e digite uma palavra
qualquer como Caption.
</p>
<p>- No Evento No Cron&ocirc;metro do Formul&aacute;rio colocar o c&oacute;digo:
</p>
<p>&nbsp;&nbsp;&nbsp; Me!lblPiscador.visible = not Me!lblPiscador.visible
</p>
<p>- Mude a Propriedade Intervalo do Cron&ocirc;metro para 500 (altere
a gosto).
</p>
<p>Esta dica foi enviada por Osiris Gopfert Moreira (a335@petrobras.com.br)
para a revista Forum Access.
<br>
&nbsp;
</p>
<p><a name="Fazendo AutoNumera&ccedil;&atilde;o voltar a iniciar de 1"></a><b><font size="+1">Fazendo
AutoNumera&ccedil;&atilde;o voltar a iniciar de 1 novamente</font></b>
<br>
&nbsp;
</p>
<p><b><font size="+1">Alterar o valor inicial de um campo AutoNumera&ccedil;&atilde;o</font></b>
</p>
<p>Para uma nova tabela que ainda n&atilde;o possua registros, voc&ecirc;
pode alterar o valor inicial de um campo AutoNumera&ccedil;&atilde;o que
tenha sua propriedade Novos Valores definida com Incremento para um n&uacute;mero
diferente de 1. Para uma tabela que possua registros, voc&ecirc; tamb&eacute;m
pode utilizar esse procedimento para alterar o pr&oacute;ximo valor atribu&iacute;do
a um novo n&uacute;mero em um campo AutoNumera&ccedil;&atilde;o.
</p>
<p>1 Crie uma tabela tempor&aacute;ria com apenas um campo, um campo N&uacute;mero;
defina sua propriedade Tamanho do Campo com Inteiro Longo e d&ecirc; a
ele o mesmo nome do campo AutoNumera&ccedil;&atilde;o na tabela cujo valor
voc&ecirc; deseja alterar.
</p>
<p>2 No modo Folha de Dados, digite um valor no campo N&uacute;mero da
Tabela tempor&aacute;ria que seja 1 a menos do que o valor inicial que
voc&ecirc; deseja para o campo AutoNumera&ccedil;&atilde;o. Por exemplo,
se voc&ecirc; desejar que o campo AutoNumera&ccedil;&atilde;o comece em
100, digite 99 no campo N&uacute;mero.
<br>
3 Crie e execute uma consulta acr&eacute;scimo para acrescentar uma
tabela tempor&aacute;ria &agrave; tabela cujo valor AutoNumera&ccedil;&atilde;o
voc&ecirc; deseja alterar.
</p>
<p>Observa&ccedil;&atilde;o&nbsp;&nbsp; Se a sua tabela original possuir
uma chave prim&aacute;ria, voc&ecirc; dever&aacute; remov&ecirc;-la temporariamente
antes de executar a consulta acr&eacute;scimo. Da mesma forma, se a sua
tabela original tiver campos que possuam a propriedade Requerido definida
como Sim, a propriedade Indexado definida como Sim (Duplica&ccedil;&atilde;o
n&atilde;o autorizada) ou as defini&ccedil;&otilde;es da propriedade RegraDeValida&ccedil;&atilde;o
do campo e/ou do registro que impedem entradas Nulas nos campos, voc&ecirc;
dever&aacute; desativar temporariamente essas defini&ccedil;&otilde;es.
</p>
<p>4 Exclua a tabela tempor&aacute;ria.
<br>
5 Exclua o registro adicionado pela consulta acr&eacute;scimo.
<br>
6 Se voc&ecirc; teve que desativar as defini&ccedil;&otilde;es de propriedade
no passo 3, retorne-as &agrave;s suas defini&ccedil;&otilde;es originais.
</p>
<p>Quando voc&ecirc; insere um registro na tabela remanescente, o Microsoft
Access utiliza um valor do campo AutoNumera&ccedil;&atilde;o igual ao valor
inserido na tabela tempor&aacute;ria mais 1.
</p>
<p>Observa&ccedil;&atilde;o&nbsp;&nbsp; Se voc&ecirc; desejar compactar
o banco de dados depois de alterar o valor inicial de AutoNumera&ccedil;&atilde;o,
certifique-se de adicionar primeiro pelo menos um registro &agrave; tabela.
Se n&atilde;o fizer isso, quando compactar o banco de dados, o valor de
AutoNumera&ccedil;&atilde;o do pr&oacute;ximo registro adicionado ser&aacute;
redefinido como 1, mais o maior valor anterior. Por exemplo, se n&atilde;o
havia registros na tabela quando voc&ecirc; redefiniu o valor inicial,
a compacta&ccedil;&atilde;o definir&aacute; o valor de AutoNumera&ccedil;&atilde;o
para o pr&oacute;ximo registro adicionado como 1; se havia registros na
tabela quando voc&ecirc; redefiniu o valor inicial e o maior valor anterior
era 50, a compacta&ccedil;&atilde;o definir&aacute; o valor de AutoNumera&ccedil;&atilde;o
para o pr&oacute;ximo registro adicionado como 51.
</p>
<p>
</p>
<hr width="100%">
</body>

<!-- Mirrored from www.psantos.org/ribafs/access/dicas.htm by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Apr 2018 10:56:20 GMT -->
</html>
